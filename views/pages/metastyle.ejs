<base href="/">

<script>
  var urlbase = window.location.origin;
     var basenow = window.location.href;
     console.log("urlbase",urlbase)
     console.log("basenow",basenow)
     function loadjscssfile(filename, filetype){
     if (filetype=="js"){ //if filename is a external JavaScript file
          var fileref=document.createElement('script')
          fileref.setAttribute("type","text/javascript")
          fileref.setAttribute("src", urlbase+"/"+filename)
     }
     else if (filetype=="css"){ //if filename is an external CSS file
          var fileref=document.createElement("link")
          fileref.setAttribute("rel", "stylesheet")
          fileref.setAttribute("type", "text/css")
          fileref.setAttribute("href", urlbase+"/"+filename)
     }
     if (typeof fileref!="undefined")
          document.getElementsByTagName("head")[0].appendChild(fileref)
     }


     loadjscssfile("lib/css/bootstrap.min.css", "css")
     loadjscssfile("lib/css/font-awesome.min.css", "css")
     loadjscssfile("lib/css/animate.min.css", "css")
     loadjscssfile("lib/css/bootstrap-switch.min.css", "css")
     loadjscssfile("lib/css/jquery.dataTables.min.css", "css")
     loadjscssfile("lib/css/select2.min.css", "css")
     loadjscssfile("css/style.css", "css")
     loadjscssfile("css/themes/flat-blue.css", "css")
     loadjscssfile("js/web3.min.js", "js")
     loadjscssfile("lib/js/jquery.dataTables.min.js", "js")
     loadjscssfile("lib/js/dataTables.bootstrap.min.js", "js")
</script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Fonts -->
<link href='http://fonts.googleapis.com/css?family=Roboto+Condensed:300,400' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Lato:300,400,700,900' rel='stylesheet' type='text/css'>
<script type="text/javascript" src="lib/js/jquery.min.js"></script>

<script>
  var dataWarranty =
    '0x608060405260018054600160a060020a03199081167336c5804a3f063487c0dc09ae93e47fc6f584f13617909155600980549091169055600d805461ffff191690553480156200004e57600080fd5b50604051606080620014fb833981018060405262000070919081019062000104565b6000805433600160a060020a031991821681179092556002805460039590955567ffffffffffffffff199094166001604060020a0395861617604060020a608060020a0319166801000000000000000093909516929092029390931790915560048054909116909117905562000167565b6000620000ef825162000158565b9392505050565b6000620000ef82516200015b565b6000806000606084860312156200011a57600080fd5b6000620001288686620000f6565b93505060206200013b86828701620000e1565b92505060406200014e86828701620000f6565b9150509250925092565b90565b6001604060020a031690565b61138480620001776000396000f3006080604052600436106100985763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416630d9bb52a811461009d578063107a9fc2146100cf5780632e5113b7146100fc57806339461991146101205780633a7ff96414610140578063525191171461016d578063ad5c613d1461018f578063d206098e146101af578063ee8379e5146101d1575b600080fd5b3480156100a957600080fd5b506100b26101f1565b6040516100c698979695949392919061120d565b60405180910390f35b3480156100db57600080fd5b506100ef6100ea366004610ea1565b61034e565b6040516100c6919061115e565b34801561010857600080fd5b506101116103e0565b6040516100c693929190611136565b34801561012c57600080fd5b506100ef61013b366004610e5d565b6103fc565b34801561014c57600080fd5b5061016061015b366004610e5d565b610683565b6040516100c691906111d0565b34801561017957600080fd5b5061018d610188366004610e5d565b61095a565b005b34801561019b57600080fd5b5061018d6101aa366004610f16565b6109fc565b3480156101bb57600080fd5b506101c4610a85565b6040516100c691906111f1565b3480156101dd57600080fd5b5061018d6101ec366004610f58565b610ad6565b6002805460035460045460055460065460078054604080516020610100600185161502600019019093168a9004601f810184900484028201840190925281815267ffffffffffffffff808a169a68010000000000000000909a041698600160a060020a0397881697909616959390929091908301828280156102b45780601f10610289576101008083540402835291602001916102b4565b820191906000526020600020905b81548152906001019060200180831161029757829003601f168201915b5050505060068301805460408051602060026001851615610100026000190190941693909304601f81018490048402820184019092528181529495949350908301828280156103445780601f1061031957610100808354040283529160200191610344565b820191906000526020600020905b81548152906001019060200180831161032757829003601f168201915b5050505050905088565b60008080600160a060020a038816151561036757600080fd5b61037087610b62565b9150600182858888604051600081526020016040526040516103959493929190611192565b60206040516020810390808403906000865af11580156103b9573d6000803e3d6000fd5b5050604051601f190151600160a060020a0390811699169890981498975050505050505050565b600a54600b54600c54600160a060020a03928316929091169083565b600d546000908190819060ff16801561041c5750600d54610100900460ff165b151561042757600080fd5b600554600160a060020a0385811691161415610581576004805460015460065460405160e260020a631df4cba5028152600160a060020a039384169492909316926377d32e949261047c929160079101611172565b602060405180830381600087803b15801561049657600080fd5b505af11580156104aa573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506104ce9190810190610e83565b600160a060020a0316149150816104e457600080fd5b60015460065460405160e260020a631df4cba5028152600160a060020a038088169316916377d32e949161051e9190600890600401611172565b602060405180830381600087803b15801561053857600080fd5b505af115801561054c573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506105709190810190610e83565b600160a060020a031614925061067c565b600454600160a060020a03858116911614156106775760055460015460065460405160e260020a631df4cba5028152600160a060020a0393841693909216916377d32e94916105d591600890600401611172565b602060405180830381600087803b1580156105ef57600080fd5b505af1158015610603573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506106279190810190610e83565b600160a060020a03161490508061063d57600080fd5b60015460065460405160e260020a631df4cba5028152600160a060020a038088169316916377d32e949161051e9190600790600401611172565b600092505b5050919050565b606061068d610ba0565b6002546040517f4228724d000000000000000000000000000000000000000000000000000000008152600160a060020a03851691634228724d916106ea9168010000000000000000900467ffffffffffffffff16906004016111ff565b600060405180830381600087803b15801561070457600080fd5b505af1158015610718573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526107409190810190610fad565b9050806060015160ff166000148015610764575060025467ffffffffffffffff1642105b15610833576040805160608181018352600454600160a060020a039081168084526005549091166020808501829052600354948601859052600a805473ffffffffffffffffffffffffffffffffffffffff199081169094179055600b8054909316909117909155600c9290925582519081018352602781527f42757965722063616e20776974682064726177206d6f6e65792066726f6d2045918101919091527f6d706c6f79657200000000000000000000000000000000000000000000000000918101919091529150610954565b60025467ffffffffffffffff16421180156108565750605a816060015160ff1610155b1561091d576040805160608181018352600454600160a060020a03168083526020808401829052600354938501849052600a805473ffffffffffffffffffffffffffffffffffffffff199081168417909155600b8054909116909217909155600c9290925582519081018352602a81527f456d706c6f7965722063616e20776974682064726177206d6f6e65792066726f918101919091527f6d20436f6e747261637400000000000000000000000000000000000000000000918101919091529150610954565b60408051808201909152601181527f446f6e7420646f20736f6d657468696e67000000000000000000000000000000602082015291505b50919050565b600054600160a060020a031633146109a7576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161099e906111e1565b60405180910390fd5b600d5460ff161580156109c25750600d54610100900460ff16155b15156109cd57600080fd5b6005805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a0392909216919091179055565b600554600160a060020a0316338114610a41576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161099e906111e1565b600d5460ff161580610a5b5750600d54610100900460ff16155b1515610a6657600080fd5b610a7260088484610bde565b5050600d805460ff191660011790555050565b610a8d610c5c565b600954600160a060020a03163314610aa457600080fd5b5060408051606081018252600a54600160a060020a039081168252600b54166020820152600c54918101919091525b90565b600054600160a060020a03163314610b1a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161099e906111e1565b600d5460ff161580610b345750600d54610100900460ff16155b1515610b3f57600080fd5b610b4b60078484610bde565b506006555050600d805461ff001916610100179055565b604080517f19457468657265756d205369676e6564204d6573736167653a0a3332000000008152601c8101839052905190819003603c019020919050565b6040805160e0810182526000808252602082018190529181018290526060808201839052608082019290925260a0810182905260c081019190915290565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10610c1f5782800160ff19823516178555610c4c565b82800160010185558215610c4c579182015b82811115610c4c578235825591602001919060010190610c31565b50610c58929150610c7c565b5090565b604080516060810182526000808252602082018190529181019190915290565b610ad391905b80821115610c585760008155600101610c82565b6000610ca282356112f0565b9392505050565b6000610ca282516112f0565b6000610ca28235610ad3565b600080601f83018413610cd357600080fd5b50813567ffffffffffffffff811115610ceb57600080fd5b602083019150836001820283011115610d0357600080fd5b9250929050565b6000601f82018313610d1b57600080fd5b8151610d2e610d29826112b8565b611291565b91508082526020830160208301858383011115610d4a57600080fd5b610d55838284611314565b50505092915050565b600060e08284031215610d7057600080fd5b610d7a60e0611291565b90506000610d888484610e39565b8252506020610d9984848301610e39565b6020830152506040610dad84828501610e39565b6040830152506060610dc184828501610e51565b6060830152506080610dd584828501610e39565b60808301525060a082015167ffffffffffffffff811115610df557600080fd5b610e0184828501610d0a565b60a08301525060c082015167ffffffffffffffff811115610e2157600080fd5b610e2d84828501610d0a565b60c08301525092915050565b6000610ca28251611301565b6000610ca2823561130e565b6000610ca2825161130e565b600060208284031215610e6f57600080fd5b6000610e7b8484610c96565b949350505050565b600060208284031215610e9557600080fd5b6000610e7b8484610ca9565b600080600080600060a08688031215610eb957600080fd5b6000610ec58888610c96565b9550506020610ed688828901610cb5565b9450506040610ee788828901610cb5565b9350506060610ef888828901610cb5565b9250506080610f0988828901610e45565b9150509295509295909350565b60008060208385031215610f2957600080fd5b823567ffffffffffffffff811115610f4057600080fd5b610f4c85828601610cc1565b92509250509250929050565b600080600060408486031215610f6d57600080fd5b833567ffffffffffffffff811115610f8457600080fd5b610f9086828701610cc1565b93509350506020610fa386828701610cb5565b9150509250925092565b600060208284031215610fbf57600080fd5b815167ffffffffffffffff811115610fd657600080fd5b610e7b84828501610d5e565b610feb816112f0565b82525050565b610feb816112fc565b610feb81610ad3565b600061100e826112ec565b808452611022816020860160208601611314565b61102b81611340565b9093016020019392505050565b6000815460018116600081146110555760018114611073576110af565b60028204607f16855260ff19821660208601526040850192506110af565b60028204808652602086019550611089856112e0565b60005b828110156110a85781548882015260019091019060200161108c565b8701945050505b505092915050565b601181527f5065726d697373696f6e2064656e696564000000000000000000000000000000602082015260400190565b805160608301906110f88482610fe2565b50602082015161110b6020850182610fe2565b50604082015161111e6040850182610ffa565b50505050565b610feb81611301565b610feb8161130e565b606081016111448286610fe2565b6111516020830185610fe2565b610e7b6040830184610ffa565b6020810161116c8284610ff1565b92915050565b604081016111808285610ffa565b8181036020830152610e7b8184611038565b608081016111a08287610ffa565b6111ad602083018661112d565b6111ba6040830185610ffa565b6111c76060830184610ffa565b95945050505050565b60208082528101610ca28184611003565b6020808252810161116c816110b7565b6060810161116c82846110e7565b6020810161116c8284611124565b610100810161121c828b611124565b611229602083018a611124565b6112366040830189610ffa565b6112436060830188610fe2565b6112506080830187610fe2565b61125d60a0830186610ffa565b81810360c083015261126f8185611003565b905081810360e08301526112838184611003565b9a9950505050505050505050565b60405181810167ffffffffffffffff811182821017156112b057600080fd5b604052919050565b600067ffffffffffffffff8211156112cf57600080fd5b506020601f91909101601f19160190565b60009081526020902090565b5190565b600160a060020a031690565b151590565b67ffffffffffffffff1690565b60ff1690565b60005b8381101561132f578181015183820152602001611317565b8381111561111e5750506000910152565b601f01601f1916905600a265627a7a723058200906a70f9abd132a32967868cf40fb31a1eb59c8bc5c7aab6d385e2447bc89816c6578706572696d656e74616cf50037';


  var abiProduct = [{
    "constant": true,
    "inputs": [],
    "name": "getAllProducts",
    "outputs": [{
      "name": "",
      "type": "uint64[]"
    }],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  }, {
    "constant": true,
    "inputs": [{
      "name": "_id",
      "type": "uint64"
    }],
    "name": "productDetail",
    "outputs": [{
      "components": [{
        "name": "id",
        "type": "uint64"
      }, {
        "name": "MFG",
        "type": "uint64"
      }, {
        "name": "EXP",
        "type": "uint64"
      }, {
        "name": "state",
        "type": "uint8"
      }, {
        "name": "idChipIOT",
        "type": "uint64"
      }, {
        "name": "manufacturer",
        "type": "string"
      }, {
        "name": "name",
        "type": "string"
      }],
      "name": "",
      "type": "tuple"
    }],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  }, {
    "constant": false,
    "inputs": [{
      "name": "_MFG",
      "type": "uint64"
    }, {
      "name": "_EXP",
      "type": "uint64"
    }, {
      "name": "_state",
      "type": "uint8"
    }, {
      "name": "_manufacturer",
      "type": "string"
    }, {
      "name": "_name",
      "type": "string"
    }],
    "name": "createProduct",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  }, {
    "constant": false,
    "inputs": [{
      "name": "_idChipIOT",
      "type": "uint64"
    }, {
      "name": "_state",
      "type": "uint8"
    }],
    "name": "updateStateOfProduct",
    "outputs": [{
      "name": "",
      "type": "bool"
    }],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  }]
  var abiLedger = [{
    "constant": false,
    "inputs": [{
      "name": "_warranty",
      "type": "address"
    }],
    "name": "saveHistory",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  }, {
    "constant": true,
    "inputs": [],
    "name": "getHistory",
    "outputs": [{
      "components": [{
        "name": "Warranty",
        "type": "address"
      }],
      "name": "",
      "type": "tuple[]"
    }],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  }, {
    "inputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "constructor"
  }]
  var abiPeople = [{
    "constant": true,
    "inputs": [{
      "name": "_owner",
      "type": "address"
    }],
    "name": "accountDetail",
    "outputs": [{
      "components": [{
        "name": "owner",
        "type": "address"
      }, {
        "name": "name",
        "type": "string"
      }, {
        "name": "homeAddr",
        "type": "string"
      }, {
        "name": "phoneNumber",
        "type": "uint32"
      }, {
        "name": "age",
        "type": "uint8"
      }, {
        "name": "Type",
        "type": "uint8"
      }],
      "name": "",
      "type": "tuple"
    }],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  }, {
    "constant": false,
    "inputs": [{
      "name": "_owner",
      "type": "address"
    }, {
      "name": "_name",
      "type": "string"
    }, {
      "name": "_homeAddr",
      "type": "string"
    }, {
      "name": "_phoneNumber",
      "type": "uint32"
    }, {
      "name": "_age",
      "type": "uint8"
    }, {
      "name": "_Type",
      "type": "uint8"
    }],
    "name": "register",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  }, {
    "constant": true,
    "inputs": [],
    "name": "getAllAccount",
    "outputs": [{
      "name": "",
      "type": "address[]"
    }],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  }, {
    "constant": false,
    "inputs": [{
      "name": "_name",
      "type": "string"
    }, {
      "name": "_homeAddr",
      "type": "string"
    }, {
      "name": "_phoneNumber",
      "type": "uint32"
    }, {
      "name": "_age",
      "type": "uint8"
    }],
    "name": "updateAccount",
    "outputs": [{
      "name": "",
      "type": "bool"
    }],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  }]
  var abiWarranty = [{
    "constant": true,
    "inputs": [],
    "name": "convention",
    "outputs": [{
      "name": "expireTime",
      "type": "uint64"
    }, {
      "name": "idProduct",
      "type": "uint64"
    }, {
      "name": "compensation",
      "type": "uint256"
    }, {
      "name": "employer",
      "type": "address"
    }, {
      "name": "buyer",
      "type": "address"
    }, {
      "name": "hash",
      "type": "bytes32"
    }, {
      "name": "signatureEmployer",
      "type": "bytes"
    }, {
      "name": "signatureBuyer",
      "type": "bytes"
    }],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  }, {
    "constant": true,
    "inputs": [{
      "name": "_owner",
      "type": "address"
    }, {
      "name": "_hash",
      "type": "bytes32"
    }, {
      "name": "r",
      "type": "bytes32"
    }, {
      "name": "s",
      "type": "bytes32"
    }, {
      "name": "v",
      "type": "uint8"
    }],
    "name": "verifyWarranty",
    "outputs": [{
      "name": "",
      "type": "bool"
    }],
    "payable": false,
    "stateMutability": "pure",
    "type": "function"
  }, {
    "constant": true,
    "inputs": [],
    "name": "benefit",
    "outputs": [{
      "name": "sender",
      "type": "address"
    }, {
      "name": "receiver",
      "type": "address"
    }, {
      "name": "balance",
      "type": "uint256"
    }],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  }, {
    "constant": true,
    "inputs": [{
      "name": "_owner",
      "type": "address"
    }],
    "name": "demonstrateMeInvalid",
    "outputs": [{
      "name": "",
      "type": "bool"
    }],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  }, {
    "constant": false,
    "inputs": [{
      "name": "_productsContract",
      "type": "address"
    }],
    "name": "courts",
    "outputs": [{
      "name": "",
      "type": "string"
    }],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  }, {
    "constant": false,
    "inputs": [{
      "name": "_buyer",
      "type": "address"
    }],
    "name": "createParnter",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  }, {
    "constant": false,
    "inputs": [{
      "name": "_signatureBuyer",
      "type": "bytes"
    }],
    "name": "purchase",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  }, {
    "constant": true,
    "inputs": [],
    "name": "getBenefit",
    "outputs": [{
      "components": [{
        "name": "sender",
        "type": "address"
      }, {
        "name": "receiver",
        "type": "address"
      }, {
        "name": "balance",
        "type": "uint256"
      }],
      "name": "",
      "type": "tuple"
    }],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  }, {
    "constant": false,
    "inputs": [{
      "name": "_signatureEmployer",
      "type": "bytes"
    }, {
      "name": "_hash",
      "type": "bytes32"
    }],
    "name": "sell",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  }, {
    "inputs": [{
      "name": "_expireTime",
      "type": "uint64"
    }, {
      "name": "_compensation",
      "type": "uint256"
    }, {
      "name": "_idProduct",
      "type": "uint64"
    }],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "constructor"
  }]
  // if(!addressContract1 || !addressContract2 || !addressContract3 || !addressContract4){
  // $.ajax({
  // type: "GET",
  // url: "getaddresscontract"
  // }).done((data)=>{
  // if(data.status){
  // addressContract1 = data.data.address[0];
  // localStorage.setItem('addressContract1',addressContract1);
  // localStorage.setItem('addressContract2',addressContract2);
  // localStorage.setItem('addressContract3',addressContract3);
  // localStorage.setItem('addressContract4',addressContract4);
  // }
  // });
  // }
</script>

<script>
  var addressContractPeople = '0x49ff36d94e164db0107eff0ea63e79613e8dec07'
  var addressContractProduct = '0x92e632af3cec18756bd4eccfed791e412255f5bc'
  var addressContractLedger = '0x2f6407acd3ffb6ba4e64a647b099940288364f21'
  var addressContractEC = '0x36c5804a3f063487c0dc09ae93e47fc6f584f136'

  var ContractPeople = null;
  var ContractProduct = null;
  var ContractLedger = null;
  var contractWarranty = null;
  // privakey acc onwer = '2A9E2FC73B905B0744250A672A02A8821CD126A8DC0DE834772C670F19533B1D'
  var addressOwner = '0x87b728b61d8a22dF222e9aAa06b08b3f9fBf769B';
  window.addEventListener('load', function () {
 
    console.log("Contract product:", addressContractProduct)
    console.log("Contract people:", addressContractPeople)
    console.log("Contract Ledger:", addressContractLedger)
    if (typeof web3 !== 'undefined') {
      // Use Mist/MetaMask's provider
      web3 = new Web3(web3.currentProvider);
    } else {
      web3 = new Web3(new Web3.providers.HttpProvider(
        "https://ropsten.infura.io/v3/79cbd8b8559f4ec1a9bbd610a8952077"));
    }
    ContractProduct = new web3.eth.Contract(abiProduct, addressContractProduct);
    ContractPeople = new web3.eth.Contract(abiPeople, addressContractPeople);
    ContractLedger = new web3.eth.Contract(abiLedger, addressContractLedger);
    ContractWarrantyabi = new web3.eth.Contract(abiWarranty);
  })
  window.addEventListener('load', async function () {
        var acc = await web3.eth.getAccounts();
        if(acc[0] != addressOwner){
          if(window.location.pathname =='/contract/'){
            alert('ban ko dc phep vao day')
            window.location.href='/';
          }
            $("#addd").hide();
            $("#menu").empty(); 
            var mang = [
                    {link: 'product',name: 'List Product',icon: 'glyphicon glyphicon-bitcoin'},
                    {link: 'customer',name: 'List Custommer',icon: 'glyphicon glyphicon-piggy-bank'},
                ]
            mang.forEach((v,k) => {
                $("#menu").append(
                    `<li>
                        <a href="${v['link']}">
                            <span class="${v['icon']}"></span><span class="title">${v['name']}</span>
                        </a>
                    </li>`
                )
            });
        }
    });
</script>